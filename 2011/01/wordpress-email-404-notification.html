<!DOCTYPE html> 
<html lang="en">
<!--
	Access keys:
		H = homepage
		S = search input field
		L = latest article on the homepage
		A = about page
-->
<head>
    <title>
        Wordpress 404 notification by email
        
    </title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="author" content="Jonathan Foucher" />
	<meta name="designer" content="Jonathan Foucher" />
	<meta name="developer" content="Jonathan Foucher" />
	<meta name="description" content="A Wordpress plugin that sends an email to the site admin when a user gets a 404 error" />
	<meta name="keywords" content="Web development, france, wordpress, codeigniter, linux, ubuntu, debian, system administration" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
	<link rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/en/" />
    <link href="http://tent.jfoucher.com/profile" rel="https://tent.io/rels/profile" />
    <link href='http://fonts.googleapis.com/css?family=Questrial' rel='stylesheet' type='text/css'>
	<!--<link rel="stylesheet" href="/assets/css/screen.css" type="text/css" media="screen" />-->

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

	<script type="text/javascript" src="/assets/js/app.js"></script>
    <link rel="stylesheet" href="/assets/css/screen.css" type="text/css" media="screen" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <script type="text/javascript" src="http://www.shrinktheweb.com/scripts/pagepix.js"></script>
	<link rel="alternate" href="http://feeds.feedburner.com/GeekyNuggets" title="Geeky Nuggets" type="application/atom+xml" />

	<link rel="shortcut icon" type="image/png" href="/favicon.png" />

</head>
<body>


	<div id="container" class="clearfix">
		                <header id="header" class="center">
            <div class="logo">
                <a href="/" title="Return to homepage" tabindex="0" accesskey="H">
                    Geeky Nuggets
                </a>
            </div>
            <div class="siteDesc"><a href="/about.html" title="About Jonathan Foucher
                &amp; contact details" tabindex="0" accesskey="A">Jonathan Foucher</a>&rsquo;s blog <span
                class="amp">&amp;</span> web development
                notebook.
            </div>
                    <nav id="nav" class="clear">
            <ul class="nav nav-header caps">
				<li><a href="/about.html" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
				<li class="active"><a href="/archives.html" title="View the blog archives" tabindex="0">Archives</a></li>

				<li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Subscribe to my posts, by email or in your feed reader" tabindex="0">Feed</a></li>
            </ul>
			<div class="sitesearch">

                <!-- Google Custom Search Element -->
                <!-- <form action="http://www.google.com/cse" class="center_column" id="searchForm" >
                    <fieldset>
                       <input type="hidden" name="cx" value="004905032692135561336:flcwnz7i1ww" />
                       <input type="hidden" name="ie" value="UTF-8" />
                       <label for="search" class="hidden">Search</label>
                       <input id="search" class="text-input" type="text" name="q" size="15" tabindex="0" accesskey="S" />
                       <input id="searchsubmit" type="submit" name="sa" value="Search" tabindex="0" />
                    </fieldset>
                </form>-->

            </div>

        </nav> <!-- /#nav.clear -->


            
		</header> <!-- /#header.center -->


		<div id="notebook" class="center clear">
			<div class="page-nav-top">
                
				    <span class="page-nav-item page-prev"><a class="internal" rel="prev"  href="/2011/01/spanish-characters-on-qwerty-keyboard-for-ubuntu-10-10.html" title="Read Spanish characters on Qwerty keyboard for Ubuntu 10.10">&larr; Read previous article</a></span>
				
				
				    <span class="page-nav-item page-next"><a class="internal" rel="next"  href="/2011/02/installing-running-apc-cache-codeigniter.html" title="Read Installing and running APC cache with CodeIgniter">Read next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-top -->

             <h2 class="post-title">
                <a href="/2011/01/wordpress-email-404-notification.html" title="Permanent link to Wordpress 404 notification by email">
                    Wordpress 404 notification by email
                </a>
            </h2>

            <div class="meta">
                <div class="hero">

                    <p>
                        A Wordpress plugin that sends an email to the site admin when a user gets a 404 error
                        <br /><small>by <a href="https://plus.google.com/+JonathanFoucher?rel=author">Jonathan Foucher</a></small>
                    </p>
                </div>
                <!-- <span class="pdf">Download a <a href="/2011/01/wordpress-email-404-notification.html.pdf" title="Download a PDF, printer-friendly copy of this article"><acronym title="Portable Document Format">PDF</acronym>, printer-friendly version of this article</a>.</span> -->
                <span class="permalink">For referencing: <a href="/2011/01/wordpress-email-404-notification.html" title="[Permalink] Wordpress 404 notification by email">permalink to this article</a>.</span>
                    <span class="date" title="Sat Jan 22 23:42:45 +0100 2011">
                    <span class="published">Published&thinsp;&bull;</span>
                    <span class="day">22</span>
                    <span class="month"><abbr>Jan</abbr></span>
                    <span class="year">2011</span>
                </span>
                <div class="share">
                    <div class="iframes">
                        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jfoucher">Tweet</a>
                        

                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    </div>
                </div>
            </div> <!-- /.meta -->
            <div id="entry-content">

                <p>I couldn't find something that did just what I wanted and no more: send me an email when someone gets a 404 error on my blog. It seems pretty simple, and it really is. More than that actually. It's problably the simplest plugin I've ever written.</p>

<p>Check it out:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">email_error</span><span class="p">(){</span>
    <span class="k">global</span> <span class="nv">$wp_query</span><span class="p">;</span>
    <span class="nv">$location</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$wp_query</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">is_404</span><span class="p">){</span>
        <span class="nx">email_admin</span><span class="p">(</span><span class="nv">$location</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span><span class="s1">&#39;get_header&#39;</span><span class="p">,</span> <span class="s1">&#39;email_error&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>


<p>This is the main part of the code, the one gets executed everytime the <code>get_header</code> hook is called. It basically just checks the $wp_query object to see if the current url gives a 404 error and then passes that url to the email_admin function</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">email_admin</span><span class="p">(</span><span class="nv">$location</span><span class="p">){</span>
    <span class="nv">$name</span><span class="o">=</span><span class="nx">get_option</span><span class="p">(</span><span class="s1">&#39;blogname&#39;</span><span class="p">);</span>
    <span class="nv">$email</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span><span class="s1">&#39;admin_email&#39;</span><span class="p">);</span>
    <span class="nv">$headers</span>  <span class="o">=</span> <span class="s2">&quot;MIME-Version: 1.0</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;Content-type: text/plain; charset=UTF-8</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$headers</span> <span class="o">.=</span> <span class="s1">&#39;From: &quot;&#39;</span> <span class="o">.</span> <span class="nv">$name</span> <span class="o">.</span> <span class="s1">&#39;&quot; &amp;lt;&#39;</span> <span class="o">.</span><span class="nv">$email</span><span class="o">.</span> <span class="s2">&quot;&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$subject</span><span class="o">=</span><span class="s1">&#39;404 error in &#39;</span><span class="o">.</span><span class="nv">$name</span><span class="p">;</span>
    <span class="nv">$body</span><span class="o">=</span><span class="s1">&#39;A 404 error occured at the following url: &#39;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$location</span><span class="p">;</span>
    <span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span><span class="nv">$subject</span><span class="p">,</span><span class="nv">$body</span><span class="p">,</span><span class="nv">$headers</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>


<p>This function sets some headers for the email, such as the sender's name and email, and the subject of the message, and then sends the message. No error is shown if the message can't be sent, as this would be displayed on the page.</p>

<p><em>UPDATE</em>: Finally available on the <a href="http://wordpress.org/extend/plugins/email-404/">wordpress plugin repository</a></p>




                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'geekynuggets'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
            </div> <!-- /.entry-content.colEight -->
            <div class="page-nav-bottom">
                
				    <span class="page-nav-item page-prev"><a class="internal" rel="prev"  href="/2011/01/spanish-characters-on-qwerty-keyboard-for-ubuntu-10-10.html#notebook" title="Read Spanish characters on Qwerty keyboard for Ubuntu 10.10">&larr; View previous article</a></span>
				
				
				    <span class="page-nav-item page-next"><a class="internal" rel="next"  href="/2011/02/installing-running-apc-cache-codeigniter.html#notebook" title="Read Installing and running APC cache with CodeIgniter">View next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-bottom -->
        </div> <!-- /#notebook.center.clear -->
            <footer id="footer" class="clear">
        <span class="backtop"><a class="internal" href="#header" title="Return to the top of this page">Back to top &uarr;</a></span>
        <nav>
            <ul id="nav-footer">
                <li><a href="/about.html" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
                <li><a href="/archives.html" title="View the blog archives" tabindex="0">Archives</a></li>

                <li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Feed link" tabindex="0">Feed</a></li>
            </ul>
        </nav>

        <div class="page-meta clear">
            <div class="info">

                <p class="copyright ">
                    This blog has been online in one form or another since
                    <span class="date" title="March 2004">2004</span><br />Copyright &copy; <a href="http://jfoucher.com">Jonathan
                    Foucher.</a><br /><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"
                       title="You can use this for non-comercial purposes, provided you cite me as the author, and do not modify the content">
                        Creative Commons License
                    </a>
                    <br />
                    <a href="/jfoucher-6px.eu.asc">GPG Key</a>
                </p>
            </div>

        </div> <!-- /.page-meta.clear -->
    </footer> <!-- /#footer.center.clear -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8465441-2']);
    _gaq.push(['_trackPageview']);



    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
        '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();


    var docHeight = document.height,
    vscroll = $(document).scrollTop();

    $(document).bind('scroll', function(){
        var docHeight = document.height,
                vscroll = $(document).scrollTop();

        if(vscroll > docHeight / 2) {
            $(document).unbind('scroll');
            _gaq.push(['_trackEvent', 'scrolled_half', 'read']);
            console.log('not a bounce')
        }
    });

    </script>

    <script type="text/javascript">
        var clicky_site_ids = clicky_site_ids || [];
        clicky_site_ids.push(100617617);
        (function() {
            var s = document.createElement('script');
            s.type = 'text/javascript';
            s.async = true;
            s.src = '//static.getclicky.com/js';
            ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
        })();
    </script>
    <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100617617ns.gif" /></p></noscript>
</body>
</html>
	</div>
