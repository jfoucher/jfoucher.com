<!DOCTYPE html> 
<html lang="en">
<!--
	Access keys:
		H = homepage
		S = search input field
		L = latest article on the homepage
		A = about page
-->
<head>
    <title>
        Implementing BrowserID identification on your website
        
    </title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="content-language" content="en" />
	<meta name="author" content="Jonathan Foucher" />
	<meta name="designer" content="Jonathan Foucher" />
	<meta name="developer" content="Jonathan Foucher" />
	<meta name="description" content="BrowserID is an identification service from Mozilla that aims to remove the need for accounts at each website we visit. I explain how to implement it on your site" />
	<meta name="keywords" content="Web development, france, wordpress, codeigniter, linux, ubuntu, debian, system administration" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
	<link rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/en/" />
    <link href="http://tent.jfoucher.com/profile" rel="https://tent.io/rels/profile" />
    <link href='http://fonts.googleapis.com/css?family=Questrial' rel='stylesheet' type='text/css'>
	<!--<link rel="stylesheet" href="/assets/css/screen.css" type="text/css" media="screen" />-->

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

    <script src="/assets/js/jquery.timeago.js" type="text/javascript"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
    <link rel="stylesheet" href="/assets/css/screen.css" type="text/css" media="screen" />
    <script src="/assets/js/less-1.1.4.js" type="text/javascript"></script>
    <!--[if lt IE 9]>
    <script type="text/javascript" src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <script type="text/javascript" src="http://www.shrinktheweb.com/scripts/pagepix.js"></script>
	<link rel="alternate" href="http://feeds.feedburner.com/GeekyNuggets" title="Geeky Nuggets" type="application/atom+xml" />

	<link rel="shortcut icon" type="image/png" href="/favicon.png" />

</head>
<body>


	<div id="container" class="clearfix">
		                <header id="header" class="center">
            <div class="logo">
                <a href="/" title="Return to homepage" tabindex="0" accesskey="H">
                    Geeky Nuggets
                </a>
            </div>
            <div class="siteDesc"><a href="/about.html#notebook" title="About Jonathan Foucher
                &amp; contact details" tabindex="0" accesskey="A">Jonathan Foucher</a>&rsquo;s blog <span
                class="amp">&amp;</span> web development
                notebook.
            </div>
                    <nav id="nav" class="clear">
            <ul class="nav nav-header caps">
				<li><a href="/about.html#notebook" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
				<li class="active"><a href="/archives.html#cover" title="View the blog archives" tabindex="0">Archives</a></li>
				<li><a href="/projects/#notebook" title="Go to the code portfolio of Jonathan Foucher" tabindex="0">Projects</a></li>
				<li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Subscribe to my posts, by email or in your feed reader" tabindex="0">Feed</a></li>
            </ul>
			<div class="sitesearch">

                <!-- Google Custom Search Element -->
                <!--<form action="http://www.google.com/cse" class="center_column" id="searchForm" >
                    <fieldset>
                       <input type="hidden" name="cx" value="004905032692135561336:flcwnz7i1ww" />
                       <input type="hidden" name="ie" value="UTF-8" />
                       <label for="search" class="hidden">Search</label>
                       <input id="search" class="text-input" type="text" name="q" size="15" tabindex="0" accesskey="S" />
                       <input id="searchsubmit" type="submit" name="sa" value="Search" tabindex="0" />
                    </fieldset>
                </form>-->

            </div>

        </nav> <!-- /#nav.clear -->


            
		</header> <!-- /#header.center -->


		<div id="notebook" class="center clear">
			<div class="page-nav-top">
                
				    <span class="page-nav-item page-prev"><a class="internal" rel="prev"  href="/2011/09/a-10-minute-script-to-graph-your-server-load.html#notebook" title="View A 10 minute script to graph your server load">&larr; View previous article</a></span>
				
				
				    <span class="page-nav-item page-next"><a class="internal" rel="next"  href="/2012/02/from-titanium-to-air-building-desktop-apps-with-javascript.html#notebook" title="View From Titanium to Adobe Air, or, Building Desktop Apps with Javascript">View next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-top -->

             <h2 class="post-title">
                <a href="/2011/12/implementing-browserid-identification.html#notebook" title="Permanent link to Implementing BrowserID identification on your website">
                    Implementing BrowserID identification on your website
                </a>
            </h2>

            <div class="meta">
                <div class="hero">

                    <p>
                        BrowserID is an identification service from Mozilla that aims to remove the need for accounts at each website we visit. I explain how to implement it on your site
                    </p>
                </div>
                <!-- <span class="pdf">Download a <a href="/2011/12/implementing-browserid-identification.html.pdf" title="Download a PDF, printer-friendly copy of this article"><acronym title="Portable Document Format">PDF</acronym>, printer-friendly version of this article</a>.</span> -->
                <span class="permalink">For referencing: <a href="/2011/12/implementing-browserid-identification.html" title="[Permalink] Implementing BrowserID identification on your website">permalink to this article</a>.</span>
                    <span class="date" title="2011-12-25T14:05:13+01:00">
                    <span class="published">Published&thinsp;&bull;</span>
                    <span class="day">25</span>
                    <span class="month"><abbr>Dec</abbr></span>
                    <span class="year">2011</span>
                </span>
                <div class="share">
                    <div class="iframes">
                        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jfoucher">Tweet</a>
                        

                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    </div>
                </div>
            </div> <!-- /.meta -->
            <div id="entry-content">

                <p>BrowserID <a href="http://identity.mozilla.com/post/7616727542/introducing-browserid-a-better-way-to-sign-in">was released a few months ago</a> and is a new way to sign in to websites or web applications that doesn't require you to give your password each time you want to login. It doesn't even require you to register as such on each website. In that way, it is very similar to openId, but without the usability issues.</p>

<p>For developpers, Mozilla set up a service that provides everything you need to let your users simply login without handling any of the dirty work yourself. <a href="http://browserid.org">http://browserid.org</a> is an identity provider that allows your users to create and manage their accounts across the web. One account for an infinite number of websites. Could this finally be our <a href="http://www.codinghorror.com/blog/2010/11/your-internet-drivers-license.html">universal login mechanism</a>?</p>

<h3><a href="https://github.com/mozilla/browserid/wiki/How-to-Use-BrowserID-on-Your-Site">Implementing BrowserID</a> on your site or app is easy</h3>

<h4>Include the following javascript snippet in your page</h4>

<div class="highlight"><pre><code class="javascript"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://browserid.org/include.js&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</code></pre>
</div>


<h4>Identify the user</h4>

<p>When the user clicks on your "Login" button, a window pops up asking them to confirm that they want to login, or asking them to create a browserID account if they haven't done it yet. Once they decide that they want to login, they are redirected to your site, and the following function is called, with the assertion being passed to the callback if the login was successful</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">navigator</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">getVerifiedEmail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">assertion</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">assertion</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// This code will be invoked once the user has successfully</span>
        <span class="c1">// selected an email address they control to sign in with.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// something went wrong!  the user isn&#39;t logged in.</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>


<p>If the assertion is there, the user authenticated successfully. now you must verify that the assertion really is authentic, and get the relevant data from it. You <em>could</em> <a href="https://wiki.mozilla.org/Identity/Verified_Email_Protocol/Latest">do it yourself</a>, but if you don't have any special requirements, I recommend you just use the service provided by <a href="http://browserid.org">http://browserid.org</a></p>

<h4>Verify the assertion</h4>

<p>To do so, and once you have the <code>assertion</code>, you have to make a POST request to <a href="http://browserid.org/verify">http://browserid.org/verify</a>, with two parameters: the assertion and the audience, which is simply the hostname of your site. This has to be done from your server. For security reasons, it won't work if you do it as an ajax request from the user's browser. What I suggest is that you call a url on your server from the javascript callback which will be in charge of itself making the request to browserid.org. Do it as a POST request as that assertion is a <em>long</em> string. This an example implementation for the <a href="http://www.slimframework.com/">Slim framework</a>:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/browserid&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>

        <span class="nv">$assertion</span><span class="o">=</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;assertion&#39;</span><span class="p">);</span>
        <span class="c1">//get the POSTed assertion</span>
        <span class="nv">$post_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;assertion&#39;</span> <span class="o">=&gt;</span> <span class="nv">$assertion</span><span class="p">,</span> <span class="s1">&#39;audience&#39;</span> <span class="o">=&gt;</span> <span class="nx">SERVER</span><span class="p">);</span>
        <span class="c1">//SERVER is my site&#39;s hostname</span>
        <span class="nv">$r</span> <span class="o">=</span> <span class="nx">Http</span><span class="o">::</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;https://browserid.org/verify&#39;</span><span class="p">,</span><span class="nv">$post_data</span><span class="p">);</span>
        <span class="c1">//This makes a post request to browserid.org</span>
        <span class="nv">$result</span><span class="o">=</span><span class="nb">json_decode</span><span class="p">(</span><span class="nv">$r</span><span class="p">,</span><span class="k">true</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;okay&#39;</span><span class="p">){</span>
            <span class="nx">handle_users</span><span class="p">(</span><span class="nv">$app</span><span class="p">,</span><span class="nv">$result</span><span class="p">);</span>
            <span class="c1">//This logs the user in if we have an account for that email address,</span>
            <span class="c1">//or creates it otherwise</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nv">$msg</span><span class="o">=</span><span class="s1">&#39;Could not log you in&#39;</span><span class="p">;</span>
            <span class="nv">$status</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
            <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="o">=&gt;</span><span class="nv">$msg</span><span class="p">,</span><span class="s1">&#39;status&#39;</span><span class="o">=&gt;</span><span class="nv">$status</span><span class="p">));</span>
        <span class="p">}</span>


    <span class="p">}</span>
<span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre>
</div>


<p>This call to the browserID API returns some json_encoded stuff, for example something like this :</p>

<div class="highlight"><pre><code class="javascript"><span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="s2">&quot;okay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="s2">&quot;lloyd@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;audience&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mysite.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expires&quot;</span><span class="o">:</span> <span class="mi">1308859352261</span><span class="p">,</span>
    <span class="s2">&quot;issuer&quot;</span><span class="o">:</span> <span class="s2">&quot;browserid.org&quot;</span>
<span class="p">}</span>
</code></pre>
</div>


<h4>Login or register</h4>

<p>If you don't get anything, or the status is not okay, something failed. Otherwise, great, your user just asked to be logged in! (or registered)</p>

<p>If the status was "okay", you then need to proceed to login your user (set session varibles, or whatever...) or register them (create an account in your database and then log them in)</p>

<p>The data returned is very basic, but allows you to check whether that user already has an account or your site or not. You are then free to ask them for additional data, such as their name, date of birth, etc...</p>

<p>And that's it! I'm really happy because now I can forget about email address verification, lost passwords and all the annoying stuff that having actual users imply. Let someone else do the hard work is what I say!! Especially when it integrates so well everywhere.</p>

<p>Oh by the way, there's a <a href="http://wordpress.org/extend/plugins/browserid/">Wordpress plugin</a> for that</p>




                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'geekynuggets'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
            </div> <!-- /.entry-content.colEight -->
            <div class="page-nav-bottom">
                
				    <span class="page-nav-item page-prev"><a class="internal" rel="prev"  href="/2011/09/a-10-minute-script-to-graph-your-server-load.html#notebook" title="Read A 10 minute script to graph your server load">&larr; View previous article</a></span>
				
				
				    <span class="page-nav-item page-next"><a class="internal" rel="next"  href="/2012/02/from-titanium-to-air-building-desktop-apps-with-javascript.html#notebook" title="Read From Titanium to Adobe Air, or, Building Desktop Apps with Javascript">View next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-bottom -->
        </div> <!-- /#notebook.center.clear -->
            <footer id="footer" class="clear">
        <span class="backtop"><a class="internal" href="#header" title="Return to the top of this page">Back to top &uarr;</a></span>
        <nav>
            <ul id="nav-footer">
                <li><a href="/about.html" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
                <li><a href="/archives.html#cover" title="View the blog archives" tabindex="0">Archives</a></li>
                <li><a href="/projects/#notebook" title="Go to the code portfolio of Jonathan Foucher" tabindex="0">Projects</a></li>
                <li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Feed link" tabindex="0">Feed</a></li>
            </ul>
        </nav>

        <div class="page-meta clear">
            <div class="info">

                <p class="copyright ">
                    This blog has been online in one form or another since
                    <span class="date" title="March 2004">2004</span><br />Copyright &copy; <a href="http://jfoucher.com">Jonathan
                    Foucher.</a><br /><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"
                       title="You can use this for non-comercial purposes, provided you cite me as the author, and do not modify the content">
                        Creative Commons License
                    </a>.
                </p>
            </div>

        </div> <!-- /.page-meta.clear -->
    </footer> <!-- /#footer.center.clear -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8465441-2']);
    _gaq.push(['_trackPageview']);



    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
        '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    </script>
            
    <!-- Piwik -->
    <script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.6px.eu/" : "http://stats.6px.eu/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://stats.6px.eu/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
    <!-- End Piwik Tracking Code -->

</body>
</html>
	</div>
