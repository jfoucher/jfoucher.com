<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="description" content="A blog about web development, codeigniter and wordpress, by web developer Jonathan Foucher" />
<title>Geeky Nuggets</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css"  href="/assets/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/assets/css/pygments.css" />
<link rel="icon" href="/favicon.png" type="image/png" /> 
<script type="text/javascript" src="/assets/js/less-1.1.3.min.js"></script>
<meta name="viewport"
  content="width=device-width,
  minimum-scale=1.0, maximum-scale=1.0" />
</head>

<body>
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">

			<div id="access" role="navigation">
				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
                <div class="menu-header">
    <ul id="menu-new" class="menu">
        <li class="menu-item">
            <a href="http://jfoucher.com">Blog</a>
        </li>
        <li class="menu-item">
            <a title="view my page on about.me" href="http://about.me/jfoucher">About
me</a>
        </li>
        <li class="menu-item">
            <a title="latest works" href="http://jfoucher.fr/">Portfolio</a>
        </li>
        <li class="menu-item"><a title="feedly inspired theme" href="http://jfoucher.com/wp-feedly">WP Feedly</a>
        </li>
    </ul>
</div>

			</div><!-- #access -->
			<div id="branding" role="banner">
				 
                <h1 id="site-title">
                  
					<span>
						<a href="/" title="Geeky Nuggets" rel="home">Geeky Nuggets</a>
					</span>
				 
                </h1>
                  

				<div id="site-description">Jonathan Foucher's blog <span class="amp">&amp;</span> web development notebook</div>
			</div><!-- #branding -->

		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">


<div id="content">


<div id="/2011/08/18/remote-debugging-with-xdebug-and-phpstorm-on-ubuntu" class="post">
<p class="the-date">18 August 2011</p>
<h2 class="entry-title"><a href="/2011/08/18/remote-debugging-with-xdebug-and-phpstorm-on-ubuntu.html" title="Permanent link to Remote debugging with Xdebug and PhpStorm on Ubuntu" rel="bookmark">Remote debugging with Xdebug and PhpStorm on Ubuntu</a></h2>
<div class="entry-content">
<p>Being able to debug your php application right from your IDE is something that you can't fully realise the power of, unless you've tried it. The advantages are immediately obvious: as soon as the connection from Xdebug is successful, you are blinded by variable inspection, code stepping, breakpoints, etc... Debugging heaven!
It took me... a few months to finally find the time figure out how to set up everything properly, so I hope this post can help someone, somewhere. But don't worry: it retrospect, it's not that difficult at all.</p>

<h3>First things first : install xdebug</h3>


<p>On Ubuntu and Debian, it couldn't be easier: just open a terminal and type <code lang="bash">sudo apt-get install php-xdebug</code> This will also install Apache and PHP if you don't have them already.</p>

<h3>Setup Xdebug on server</h3>


<p>Done? Right, so this created a config file in /etc/php5/conf.d called xdebug.ini, which is read by php and contains xdebug's configuration options. You'll need to open this file for editing as root, as we need to make a few changes in there. you can copy/paste the command below in the terminal, or do it your own way.</p>

<div class="highlight"><pre><code class="bash">gksu gedit /etc/apache2/conf.d/xdebug.ini
</code></pre>
</div>


<p>Within this file, there will be a single line, referencing the xdebug zend extension, something like this (the path can vary slightly)</p>

<div class="highlight"><pre><code class="ini"><span class="na">zend_extension</span><span class="o">=</span><span class="s">/usr/lib/php5/20090626/xdebug.so</span>
</code></pre>
</div>


<p>This is what we're going to add:</p>

<div class="highlight"><pre><code class="ini"><span class="na">xdebug.remote_enable</span><span class="o">=</span><span class="s">On ;this enables remote debugging</span>
<span class="na">xdebug.remote_host</span><span class="o">=</span><span class="s">192.168.1.83 ;change this IP adress for the one of the computer you are typing on</span>
<span class="na">xdebug.remote_port</span><span class="o">=</span><span class="s">9000 ;this is the default, leave it as is</span>
</code></pre>
</div>


<p>Now we restart apache so that the new configuration is taken into account:</p>

<div class="highlight"><pre><code class="bash">sudo /etc/init.d/apache2 restart
</code></pre>
</div>


<p>And we that we are <em>done</em> on the server side of things</p>

<h3>Prepare PhpStorm</h3>


<p>Switch to the computer where PhpStorm is installed, and open your project. All you have to do is click on the "Accept debug connections" button, and activate Xdebug by using a browser extension. ï¿½Here are four extensions to do this:</p>

<ul>
    <li><a href="https://addons.mozilla.org/en-US/firefox/addon/58688">Firefox</a></li>
    <li><a href="https://chrome.google.com/extensions/detail/eadndfjplgieldjbigjakmdgkmoaaaoc">Chrome</a></li>
    <li><a href="http://benmatselby.posterous.com/xdebug-toggler-for-safari">Safari</a></li>
    <li><a href="https://addons.opera.com/addons/extensions/details/xdebug-launcher/?display=en">Opera</a></li>
</ul>


<p>Use your preferred extension to activate Xdebug for the page you're on. Go back to PhpStorm, and instruct it to listen to incoming debug connections by clicking on the "Listen PHP debug connections" button <img class="alignnone" title="accept connection button" src="http://i.imgur.com/uMBOg.png" alt="" width="28" height="26" /></p>

<p>Now all you have to is set a breakpoint and reload your page.</p>

<p>[caption id="" align="aligncenter" width="319" caption="Setting a breakpoint in PhpStorm"]<img title="Setting breakpoint" src="http://i.imgur.com/9AuKc.png" alt="Setting breakpoint" width="319" height="173" />[/caption]</p>

<p>A window will popup asking you if PhpStorm should accept the connection from Xdebug</p>

<p>[caption id="" align="aligncenter" width="331" caption="Accepting connection from Xdebug on PhpStorm"]<img title="Accepting connection from Xdebug" src="http://i.imgur.com/2fZKq.png" alt="Accepting connection from Xdebug" width="331" height="398" />[/caption]</p>

<p>Just click debug and happy bug squishing!</p>

</div>
<!-- End .entry-content -->
</div>
<!-- End .post -->

<div id="/2011/06/29/phing-task-to-update-twitter-status" class="post">
<p class="the-date">29 June 2011</p>
<h2 class="entry-title"><a href="/2011/06/29/phing-task-to-update-twitter-status.html" title="Permanent link to A Phing task to update your Twitter status" rel="bookmark">A Phing task to update your Twitter status</a></h2>
<div class="entry-content">
<h3>Phing and Twitter</h3>


<p>I recently starting working with <a title="PHP build and deployment tool" href="http://www.phing.info">phing</a> to automate the build and deployement process for the web apps I'm building. I use it to compile my LESS files to CSS and minimize then, to compress and concatenate the javascript files, to optimize images using <a href="http://www.smushit.com/">smushit</a>, etc...</p>

<p>I like to be able to comunicate exactly what I'm doing, and thankfully Phing has a built in task to email a message to a list of recipients, which is good, but slightly old school. I wanted something that would be able to integrate readily with twitter, i.e. update my status when a build was completed. I saw <a href="http://codeinthehole.com/archives/14-Phing-task-to-update-Twitter-status.html">this post</a>, which unfortunately uses Basic Auth. As you doubtless know, <a href="http://dev.twitter.com/pages/basic_auth_shutdown">Twitter deprecated this form of authentication</a>, and now asks all users to authenticate using <a href="http://dev.twitter.com/pages/basic_to_oauth">OAuth</a>.</p>

<h3>Download twitterOAuth library</h3>


<p>That meant I had to roll my own phing task... However, thanks to great work by cleverer people, doing it was quite simple. Using <a href="http://abrah.am/">Abraham Williams'</a> <a href="https://github.com/abraham/twitteroauth">twitteroauth</a> library means that the coding I'd have to do was greatly reduced. Awesome, because <a href="http://www.codinghorror.com/blog/2005/08/how-to-be-lazy-dumb-and-successful.html">I aim to be lazy</a>.</p>

<p>The first step is to <a href="https://github.com/abraham/twitteroauth/tarball/master">download the twitteroauth library</a> from github. Extract it to a temporary folder and copy the subfolder <code lang="bash" inline="true">twitteroauth</code> to the folder where your fing tasks are stored (on my system it is <code lang="bash" inline="true">/usr/share/php/phing/tasks/my/</code>. Please note you might have to create the <code lang="bash" inline="true">my/</code> folder within <code lang="bash" inline="true">/usr/share/php/phing/tasks/</code>. You will need root privileges for these steps.</p>

<h3>Register application with Twitter</h3>


<p>Secondly, you need to <a href="https://dev.twitter.com/apps/new">register an application with twitter</a>, as you will need a consumer key and consumer secret later on. Please <a href="https://dev.twitter.com/apps/new">do so now</a>, and come back once you have your app data available.</p>

<h3>Create the custom phing task</h3>


<p>Next up is creating the actual task PHP class. Create an empty file named TwitterUpdateTask.php <code lang="bash">sudo touch /usr/share/php/phing/tasks/my/TwitterUpdateTask.php</code> and open it for editing with your favorite editor. We'll use gedit : <code lang="bash">gksu gedit /usr/share/php/phing/tasks/my/TwitterUpdateTask.php</code></p>

<p>The code for this file is as shown below:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>

<span class="k">require_once</span> <span class="p">(</span><span class="s2">&quot;phing/Task.php&quot;</span><span class="p">);</span>
<span class="k">require_once</span> <span class="p">(</span><span class="s2">&quot;phing/tasks/my/twitteroauth/twitteroauth.php&quot;</span><span class="p">);</span>


<span class="cm">/* get the lines below from http://twittertokens.6px.eu/ */</span>

<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;CONSUMER_KEY&#39;</span><span class="p">,</span> <span class="s1">&#39;Your Consumer Key Here&#39;</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;CONSUMER_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;Your Consumer Secret Here&#39;</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;OAUTH_TOKEN&#39;</span><span class="p">,</span> <span class="s1">&#39;Your OAuth Token Here&#39;</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;OAUTH_TOKEN_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;Your Oauth Token Secret Here&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">TwitterUpdateTask</span> <span class="k">extends</span> <span class="nx">Task</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nv">$message</span><span class="p">;</span>

    <span class="cm">/*</span>
<span class="cm">     * The setter for the status message</span>
<span class="cm">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setMessage</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span><span class="o">=</span><span class="nv">$str</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="cm">/* Connect to twitter */</span>
        <span class="nv">$connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TwitterOAuth</span><span class="p">(</span><span class="nx">CONSUMER_KEY</span><span class="p">,</span> <span class="nx">CONSUMER_SECRET</span><span class="p">,</span> <span class="nx">OAUTH_TOKEN</span><span class="p">,</span> <span class="nx">OAUTH_TOKEN_SECRET</span><span class="p">);</span>
        <span class="cm">/* Pass the status message as a parameter */</span>
        <span class="nv">$parameters</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span><span class="p">);</span>
        <span class="cm">/* Post the data to the API endpoint */</span>
        <span class="nv">$status</span> <span class="o">=</span> <span class="nv">$connection</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;statuses/update&#39;</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$status</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">)){</span>
            <span class="cm">/* if there is an error, fail the build */</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">BuildException</span><span class="p">(</span><span class="nv">$status</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="cm">/* if there is no error, show a success message */</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="p">(</span><span class="s2">&quot;Status posted to twitter&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>




<h3>Get the OAuth token and secret</h3>


<p>Don't close this file, we still need to add the authentication data to it. You can already place your consumer key and consumer secret in the apropriate <code lang="php" inline="true">define()</code> calls (the first two lines), but if not, we'll do it now.</p>

<p>Navigate to <a href="http://twittertokens.6px.eu">http://twittertokens.6px.eu</a>, put your consumer data and consumer secret in the apropriate fields and click on "Sign in with Twitter". A twitter page will open asking for your confirmation. Click "Sign in" and you are redirected to http://twittertokens.6px.eu/. You should see 4 lines of code appear, that look like this:</p>

<div class="highlight"><pre><code class="php"><span class="x">define(&#39;CONSUMER_KEY&#39;, &#39;V1UsnZJrgfhgKJFoqsQ&#39;);</span>
<span class="x">define(&#39;CONSUMER_SECRET&#39;, &#39;UUazcBfXrWW1jcpiSU564hg654t1EMki8gzptQU&#39;);</span>
<span class="x">define(&#39;OAUTH_TOKEN&#39;, &#39;325454656-EuCudghg8tTYwKf9yjt5nhqr14i5egHJPeVRGVxQv&#39;);</span>
<span class="x">define(&#39;OAUTH_TOKEN_SECRET&#39;, &#39;gh6854hg6tyGEvGEiEi15XmUtOmDpaONM&#39;);</span>
</code></pre>
</div>


<p>Copy this code to the corresponding spot in the TwitterUpdateTask.php file, overwriting what's already there.</p>

<p>Please note though that I'm not making any claims as to how secure this is or whatever. I don't store any of your data anywhere, but if sending your application consumer token and secret worries you, find another way to get the Oauth tokens.</p>

<h3>Create the build file</h3>


<p>First, we define the custom task:</p>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;taskdef</span> <span class="na">name=</span><span class="s">&quot;twitterupdate&quot;</span> <span class="na">classname=</span><span class="s">&quot;phing.tasks.my.TwitterUpdateTask&quot;</span> <span class="nt">/&gt;</span>
</code></pre>
</div>


<p>Secondly, let's create a custom target that will send a tweet with the message we want.</p>

<div class="highlight"><pre><code class="xml">    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;tweet&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;twitterupdate</span> <span class="na">message=</span><span class="s">&quot;${twitter.status}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>
</code></pre>
</div>


<p>Now we can call this task from another one, but we need to make that the twitter.status is set. Let's we have a "staging" target. Part of it could look like this:</p>

<div class="highlight"><pre><code class="xml">    <span class="c">&lt;!-- Set the timestamp to be used in the twitter update --&gt;</span>
    <span class="nt">&lt;tstamp&gt;</span>
        <span class="nt">&lt;format</span> <span class="na">property=</span><span class="s">&quot;build.time&quot;</span> <span class="na">pattern=</span><span class="s">&quot;%Y-%m-%d %H:%I&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/tstamp&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;twitter.status&quot;</span> <span class="na">value=</span><span class="s">&quot;Staging build completed at ${build.time}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;phingcall</span> <span class="na">target=</span><span class="s">&quot;tweet&quot;</span> <span class="nt">/&gt;</span>
</code></pre>
</div>


<p>This will post the message to twitter, replacing the <code lang="php" inline="true">${build.time}</code> token by the actual build and time.</p>

<p>Do you use Phing for your webapp build and deployment? If so, please share any custom tasks you might have created.</p>

</div>
<!-- End .entry-content -->
</div>
<!-- End .post -->

<div id="/2011/04/11/css-minification-library-for-codeigniter" class="post">
<p class="the-date">11 April 2011</p>
<h2 class="entry-title"><a href="/2011/04/11/css-minification-library-for-codeigniter.html" title="Permanent link to CSS minification library for codeigniter" rel="bookmark">CSS minification library for codeigniter</a></h2>
<div class="entry-content">
<p>For my latest project, I wanted to be able to easily minify CSS stylesheets, using the simplest syntax possible, ideally using a simple tag in the header, like <code lang="php">
&lt;?php echo $this->css->link(array('/assets/css/fonts.css','/assets/css/layout.css');?></code></p>

<p>After some searching, I found a css minification library for PHP, <a href="https://code.google.com/p/minify/">minify</a></p>

<p>It was very easy to modify it so that It could be used in our CodeIgniter applications like any other libraries.
All I did was wrap the main minification function in Codeigniter specific code.
I modelled the interaction on the image library, as I guess that's what most people are used to.</p>

<p>[caption id="attachment_450" align="aligncenter" width="300" caption="css minification library for codeigniter"]<a href="http://cdn.jfoucher.com/uploads/2011/04/Screenshot.png"><img class="size-medium wp-image-450" title="css minification for codeigniter" src="http://cdn.jfoucher.com/uploads/2011/04/Screenshot-300x162.png" alt="css minification for codeigniter" width="300" height="162" /></a>[/caption]</p>

<h3>How to use</h3>


<p>Using the library involves loading it, setting up an array with some configuration values, such as the source css file(s), the destination file (optional) or the time that the generated file should be cached, and finally initializing the library with the configuration array() .</p>

<p>The following code, which should go in your controller, will look very familiar to Codeigniter users.</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">load</span><span class="o">-&gt;</span><span class="na">library</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">);</span>
<span class="c1">//array of files to concatenate and minify</span>
<span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;source_file&#39;</span><span class="p">]</span><span class="o">=</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;/assets/css/layout.css&#39;</span><span class="p">,</span><span class="s1">&#39;/assets/css/fonts.css&#39;</span><span class="p">);</span>
<span class="c1">//where to output the result</span>
<span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;dest_file&#39;</span><span class="p">]</span><span class="s1">&#39;/assets/css/css.min.css&#39;</span><span class="p">;</span>
<span class="c1">//Cache time in hours</span>
<span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;cache_time&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">48</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">css</span><span class="o">-&gt;</span><span class="na">initialize</span><span class="p">(</span><span class="nv">$config</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">css</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">();</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre>
</div>


<p>Will output the following stylesheet tag:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;/assets/css/css.min.css&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">media=</span><span class="s">&quot;screen&quot;</span> <span class="nt">/&gt;</span>
</code></pre>
</div>




<h3>Get It!</h3>


<p>You can <a href="https://github.com/jfoucher/codeigniter-css-library">get it from GitHub</a>. Don't forget to fork it if you think you can make it better!</p>

<h3>Finally</h3>


<p>I'm not sure the way I've done it, using a</p>

<div class="highlight"><pre><code class="php"><span class="x">$config</span>
</code></pre>
</div>


<p> array and so on, is the best way. It might be a bit overkill for such a simple library. I'd love to hear your thoughts on the subject.</p>

</div>
<!-- End .entry-content -->
</div>
<!-- End .post -->

<div id="/2011/04/03/the-making-of-flickholdr-an-image-placeholder-generator" class="post">
<p class="the-date">03 April 2011</p>
<h2 class="entry-title"><a href="/2011/04/03/the-making-of-flickholdr-an-image-placeholder-generator.html" title="Permanent link to <!--:en-->The making of flickholdr.com, an image placeholder generator<!--:-->" rel="bookmark"><!--:en-->The making of flickholdr.com, an image placeholder generator<!--:--></a></h2>
<div class="entry-content">
<!--:en-->


<p>There are a few services available to web designer and HTML coders to use dummy images in their html mockups or templates. The one I used to use is <a href="http://dummyimage.com">dummyimage</a> but it is somewhat limited in that the images are completely static: a flat color and some text. I needed the same kind of service, but with actual images or photographs rather than simple placeholders. Something like dynamically generated stock images.</p>

<h2>The idea</h2>


<p>And then the idea dawned on me: why not use <a href="http://flickr.com">flickr</a>'s <a href="http://creativecommons.org/">creative commons</a> licensed images? The quality is often very good, especially for "interesting" images, a lot of sizes are available, and users often use tags to classify their images, making it rather easy to get placeholder images about a particular subject.</p>

<p>[caption id="attachment_413" align="aligncenter" width="600" caption="flickholdr.com"]<a href="http://cdn.jfoucher.com/uploads/2011/03/FlickHoldr1.png"><img class="size-full wp-image-413" title="FlickHoldr" src="http://cdn.jfoucher.com/uploads/2011/03/FlickHoldr1.png" alt="screenshot of flickholdr.com" width="600" height="417" /></a>[/caption]</p>

<h2>The execution</h2>


<p>So I proceeded to develop a little webapp to do just that, using <a href="http://codeigniter.com">codeigniter</a>, my framework of choice for rapid application development</p>

<p>I used Codeigniter 2.0 from bitbucket, as I think it is the most up-to-date code available at the moment.</p>

<p>If the requested image already exists in the cache (i.e. it has already been requested) we simply echo that out, with proper headers, otherwise, we have to generate the image.</p>

<h2>Getting images from flickr</h2>


<p>Most of the code deals with pulling images from flickr, and then doing various to them before display. The code that pulls the image from flickr is located in a model called Flickr_model with three methods:</p>

<ol>
    <li>A public method called <code lang="php" inline="true">search()</code>  that gets images using the <a href="http://www.flickr.com/services/api/">flickr API</a></li>
    <li>A private method called <code lang="php" inline="true">_get_sizes()</code> that finds the sizes available for that particular image</li>
    <li>Another private method <code lang="php" inline="true">_get_author()</code> that gets the information for the image and returns the name of the author, to be displayed in the watermark</li>
</ol>


<p>The <code lang="php" inline="true">search()</code> method returns as soon as it finds an image of at least the required size.</p>

<p>The controller private method <code lang="php" inline="true">_get_image()</code> then takes charge of resizing, cropping and watermarking the image, using codeigniter's <a title="Codeigniter image manipulation class manual" href="http://codeigniter.com/user_guide/libraries/image_lib.html">image manipulation library</a> to keep things quick and simple. I just tweaked the watermarking method of that class to allow for semi-transparent watermarks.</p>

<p>The controller then sends the image to the browser with the proper headers.</p>

<h3>End of the story!</h3>


<p><strong>UPDATE</strong>: Flickholdr is now open sourced and the code is available on <a href="https://github.com/jfoucher/flickholdr">github</a><!--:--></p>

</div>
<!-- End .entry-content -->
</div>
<!-- End .post -->

<div id="/2011/02/13/installing-running-apc-cache-codeigniter" class="post">
<p class="the-date">13 February 2011</p>
<h2 class="entry-title"><a href="/2011/02/13/installing-running-apc-cache-codeigniter.html" title="Permanent link to <!--:en-->Installing and running APC cache with CodeIgniter<!--:-->" rel="bookmark"><!--:en-->Installing and running APC cache with CodeIgniter<!--:--></a></h2>
<div class="entry-content">
<!--:en-->


<p><span style="color: #000000; line-height: 27px;">APC cache</span> Codeigniter 2 now includes an excellent cache driver, which makes it dead easy to use any one of the great available cache librairies such as <a href="http://php.net/apc">APC</a> o <a href="http://www.memcached.org/">memcached</a>. In this post I will focus on APC, it's installation on an <a href="/?p=193">Ubuntu 10.04 server</a>, and a few benchmarks to compare the various cache systems.  For my testing, I will use an Ubuntu Server installation, on a VirtualBox virtual machine with 256 Mb of RAM and a single processor. This enables me to test things until everything breaks, than just scrap that VM and start with a clean one. However, a description of this setup is a story for another day...</p>

<h3>Installation</h3>


<p>On Ubuntu, and on other debian based linuxes, you can install APC by typing <code lang="bash">sudo apt-get install php-apc</code> on the command line. Of course, you will have to install Apache and php before that, but that is really easy: <code lang="bash">sudo apt-get install php5</code> will install <a href="http://php.net">PHP</a> and all needed dependencies, including <a href="http://apache.org">apache</a> So now that APC is installed, just restart apache <code lang="bash">sudo /etc/init.d/apache2 restart</code> and you're ready to go.  In codeigniter, you don't need to do anything special. Just turn the cache on by putting the following line somewhere in your controller:  <code lang="php">$this-&gt;output-&gt;cache(n);</code> Where 'n' is the number of minutes to cache that particular content.  The cache library is clever enough to pick the best cache driver from the four available ones (memcached, APC, file and dummy). Forget about the dummy driver: it doesn't do anything</p>

<h3>Benchmarks</h3>


<p>These are the results for 50 concurrent connections : For APC we get about 43 requests/s, with the file caching mecanism around 25, requests/s, and with no cache at all we are below 18 requests/s</p>

<p style="text-align: center;"><a href="http://cdn.jfoucher.com/uploads/2011/02/chart22.png"><img class="aligncenter size-full wp-image-387" title="Codeigniter APC cache benchmark" src="http://cdn.jfoucher.com/uploads/2011/02/chart22.png" alt="APC: 43, File: 25, None: 18 " width="560" height="260" /></a></p>


<p style="text-align: left;">For low concurency (2) the improvement when using APC is similar: in this case the number of requests per second nearly doubled, from 19 to 47 between the case without any caching system and the APC case</p>


<p style="text-align: left;"><a href="http://cdn.jfoucher.com/uploads/2011/02/chart2.png"><img class="aligncenter size-full wp-image-383" title="Codeigniter cache benchmark: low concurency" src="http://cdn.jfoucher.com/uploads/2011/02/chart2.png" alt="APC: 46.37 rps, File: 27.23 rps, None: 18.99 rps" width="560" height="260" /></a></p>


<p style="text-align: left;">So just turning the default codeigniter cache on gives us a significant speed improvement, going all the way and installing APC can nearly double the speed of your application. Not too shabby I should think.</p>


<p style="text-align: left;">It is <strong>so</strong> easy to take advantage of this caching mechasism on Codeigniter 2 that it would really be a pity not to do so!</p>


<p style="text-align: left;">The only caching library missing here is memcached. Have you tried any of these caching libraries with codeigniter 2?</p>


<p style="text-align: left;"></p>


<!--:-->


<!--:fr-->


<p>
</p>


<p></p>


<!--:-->


</div>
<!-- End .entry-content -->
</div>
<!-- End .post -->







</div>
<div id="primary" class="widget-area" role="complementary">
<ul class="xoxo">
    <li id="archives-3" class="widget-container widget_archive">
        <h3 class="widget-title">Archives</h3>
        <ul>
            <li><a href='http://jfoucher.com/2011/08' title='August 2011'>August 2011</a></li>
            <li><a href='http://jfoucher.com/2011/06' title='June 2011'>June 2011</a></li>
            <li><a href='http://jfoucher.com/2011/04' title='April 2011'>April 2011</a></li>
            <li><a href='http://jfoucher.com/2011/02' title='February 2011'>February 2011</a></li>
            <li><a href='http://jfoucher.com/2011/01' title='January 2011'>January 2011</a></li>
            <li><a href='http://jfoucher.com/2010/05' title='May 2010'>May 2010</a></li>
            <li><a href='http://jfoucher.com/2010/01' title='January 2010'>January 2010</a></li>
            <li><a href='http://jfoucher.com/2009/12' title='December 2009'>December 2009</a></li>
            <li><a href='http://jfoucher.com/2009/11' title='November 2009'>November 2009</a></li>
            <li><a href='http://jfoucher.com/2009/10' title='October 2009'>October 2009</a></li>
            <li><a href='http://jfoucher.com/2009/07' title='July 2009'>July 2009</a></li>
            <li><a href='http://jfoucher.com/2009/06' title='June 2009'>June 2009</a></li>
            <li><a href='http://jfoucher.com/2009/05' title='May 2009'>May 2009</a></li>
            <li><a href='http://jfoucher.com/2009/04' title='April 2009'>April 2009</a></li>
            <li><a href='http://jfoucher.com/2006/03' title='March 2006'>March 2006</a></li>
            <li><a href='http://jfoucher.com/2005/04' title='April 2005'>April 2005</a></li>
            <li><a href='http://jfoucher.com/2005/03' title='March 2005'>March 2005</a></li>
            <li><a href='http://jfoucher.com/2004/11' title='November 2004'>November 2004</a></li>
            <li><a href='http://jfoucher.com/2004/10' title='October 2004'>October 2004</a></li>
            <li><a href='http://jfoucher.com/2004/09' title='September 2004'>September 2004</a></li>
            <li><a href='http://jfoucher.com/2004/08' title='August 2004'>August 2004</a></li>
            <li><a href='http://jfoucher.com/2004/04' title='April 2004'>April 2004</a></li>
            <li><a href='http://jfoucher.com/2004/03' title='March 2004'>March 2004</a></li>
        </ul>
    </li>
    <li id="text-6" class="widget-container widget_text">
        <div class="textwidget">
            <a href="http://stackoverflow.com/users/210824/jfoucher">
<img src="http://stackexchange.com/users/flair/f354d74ced334d5984ea2db33cf8024a.png" width="208" height="58" alt="profile for jfoucher on Stack Exchange, a network of free, community-driven Q&amp;A sites" title="profile for jfoucher on Stack Exchange, a network of free, community-driven Q&amp;A sites"> 
</a> 
<div style="margin-right:15px;float:left;"><a href="http://twitter.com/share" class="twitter-share-button" data-count="vertical">Tweet</a></div><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script> 
<g:plusone size="tall" count="true"></g:plusone> 
<iframe src="http://www.facebook.com/plugins/like.php?app_id=228358510507833&amp;href&amp;send=false&amp;layout=box_count&amp;width=50&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font=segoe+ui&amp;height=60" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:50px; height:60px;margin-left:25px" allowTransparency="true"></iframe></div> 
		</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><a class="comment-post-title-link" href="http://jfoucher.com/2011/04/css-minification-library-for-codeigniter.html#comment-14518"><!--:en-->CSS minification library for codeigniter<!--:--></a> (2)</li><li class="recentcomments"><a class="comment-post-title-link" href="http://jfoucher.com/2011/01/python-skype-notifier-for-ubuntu.html#comment-12631"><!--:en-->Python skype notifier for Ubuntu<!--:--></a> (15)</li><li class="recentcomments"><a class="comment-post-title-link" href="http://jfoucher.com/2009/06/wpfeedly-theme-download.html#comment-12060"><!--:en-->WP-Feedly theme available for download<!--:--></a> (6)</li><li class="recentcomments"><a class="comment-post-title-link" href="http://jfoucher.com/2011/01/wordpress-email-404-notification.html#comment-10882">WordPress 404 notification by email</a> (2)</li><li class="recentcomments"><a class="comment-post-title-link" href="http://jfoucher.com/2009/06/auto-tag-wordpress-plugin.html#comment-9966"><!--:en-->Auto Tag WordPress plugin<!--:--></a> (44)</li></ul></li><li id="text-8" class="widget-container widget_text"><h3 class="widget-title">Subscribe</h3>			<div class="textwidget"><ul> 
<li> 
<a href="http://feeds.feedburner.com/GeekyNuggets" rel="alternate" type="application/rss+xml">Subscribe in a reader</a>&nbsp;<a href="http://feeds.feedburner.com/GeekyNuggets" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a></li> 
<li> 
<a href="http://feedburner.google.com/fb/a/mailverify?uri=GeekyNuggets&amp;loc=en_US">Subscribe by Email</a>&nbsp;<a href="http://feedburner.google.com/fb/a/mailverify?uri=GeekyNuggets&amp;loc=en_US"><img src="/wp-content/themes/jfoucher/images/icon_email_small.gif" style="vertical-align:middle;border:0" alt="" /></a></li></ul></div> 

</li>
</ul>

</div><!-- #primary .widget-area -->
</div>
<!--End #main -->
<div id="footer">
</div>
<script type="text/javascript" src="http://use.typekit.com/mmi3jba.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>


</body>
</html>

