<!DOCTYPE html> 

<html lang="en">

<!-- 
	Access keys:
		H = homepage
		S = search input field
		L = latest article on the homepage
		F = portfolio
		A = about page
		
		N = next portfolio preview item
		P = previous prtoflio preview item
-->
<head>
    <title>Installing and running APC cache with CodeIgniter</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="content-language" content="en" />
	<meta name="author" content="Jonathan Foucher" />
	<meta name="designer" content="Jonathan Fouch" />
	<meta name="developer" content="Jonathan Foucher" />
	<meta name="description" content="We take advantage of Codeigniter 2's cached mechanism to dramatically speed up our sites with APC" />
	<meta name="keywords" content="" />
	<meta name="robots" content="noydir, noopd" /> <!-- Opt out of ODP -->

	<link rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/en/" />
	<link rel="stylesheet/less" href="/assets/css/screen.less" type="text/css" media="screen" />
	<link rel="stylesheet" href="/assets/css/print.css" type="text/css" media="print" />

	<link rel="alternate" href="http://feeds.feedburner.com/GeekyNuggets" title="Geeky Nuggets" type="application/atom+xml" />
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src="/assets/js/less-1.1.4.js" type="text/javascript"></script>
    <script src="/assets/js/jquery.timeago.js" type="text/javascript"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8465441-2']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
        '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    </script>
</head>

<body>
	<div id="container" class="clearfix">
		                <div id="header" class="center">
            <div class="article-logo">
                <h1>
				    <a href="/" title="Return to homepage" tabindex="0" accesskey="H">
				        <span class="hoverline">Geeky Nuggets</span>
				    </a>
                </h1>
            </div>
            <div class="hero">
                <p class="moin">
                    
                    You&#8217;re currently viewing a single article. Feel free to skip back to
                    <a href="/" rel="home" title="Go back to the homepage" tabindex="0">&sect; Index</a> or straight to
                    <a href="/#notebook" title="Skip straight to the latest article" tabindex="0" accesskey="L">&sect; Latest article</a>.
                </p>
                <p>
                    We take advantage of Codeigniter 2's cached mechanism to dramatically speed up our sites with APC
                </p>
			</div>
		</div> <!-- /#header.center -->
		        <div id="nav" class="clear">
            <ul class="nav nav-header caps">
				<li><a href="/about.html#notebook" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
				<li><a href="/archives.html#cover" title="View the blog archives" tabindex="0">Archives</a></li>
				<li><a href="http://github.com/jfoucher" title="Go to the code portfolio of Jonathan Foucher" tabindex="0">Github</a></li>
				<li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Feed link" tabindex="0">Feed</a></li>
            </ul>
			<div class="sitesearch floatRight">
                <div class="sitesearch">
                    <!-- Google Custom Search Element -->
                    <form action="http://www.google.com/cse" class="center_column" id="searchForm" />
                    <fieldset>
                       <input type="hidden" name="cx" value="004905032692135561336:flcwnz7i1ww" />
                       <input type="hidden" name="ie" value="UTF-8" />
                       <input id="search" class="text-input" type="text" name="q" size="15" tabindex="0" accesskey="S" />
                       <input id="searchsubmit" type="submit" name="sa" value="Search" tabindex="0" />
                    </fieldset>
                </div>
            </div>
			<div class="clear"></div>
        </div> <!-- /#nav.clear -->

		<div id="notebook" class="center clear">
			<div class="page-nav-top">
                
				    <span class="page-nav-item floatLeft"><a class="internal" rel="prev"  href="/2011/01/wordpress-email-404-notification.html#notebook" title="View Wordpress 404 notification by email">&larr; View previous article</a></span>
				
				
				    <span class="page-nav-item floatRight"><a class="internal" rel="next"  href="/2011/04/the-making-of-flickholdr-an-image-placeholder-generator.html#notebook" title="View The making of flickholdr.com, an image placeholder generator">View next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-top -->

            <h2 class="clear">Installing and running APC cache with CodeIgniter</h2>
            <span class="date" title="2011-02-13T23:33:33+01:00">
                <span class="published">Published&thinsp;&bull;</span>
                <span class="day">13</span>
                <span class="month"><abbr>Feb</abbr></span>
                <span class="year">2011</span>
            </span>
            <div id="entry-content">
                <p>Codeigniter 2 now includes an excellent cache driver, which makes it dead easy to use any one of the great available cache librairies such as <a href="http://php.net/apc">APC</a> o <a href="http://www.memcached.org/">memcached</a>. In this post I will focus on APC, it's installation on an <a href="/?p=193">Ubuntu 10.04 server</a>, and a few benchmarks to compare the various cache systems.  For my testing, I will use an Ubuntu Server installation, on a VirtualBox virtual machine with 256 Mb of RAM and a single processor. This enables me to test things until everything breaks, than just scrap that VM and start with a clean one. However, a description of this setup is a story for another day...</p>

<h3>Installation</h3>


<p>On Ubuntu, and on other debian based linuxes, you can install APC by typing</p>

<div class="highlight"><pre><code class="bash">sudo apt-get install php-apc
</code></pre>
</div>


<p> on the command line. Of course, you will have to install Apache and php before that, but that is really easy:</p>

<div class="highlight"><pre><code class="bash">sudo apt-get install php5
</code></pre>
</div>


<p> will install <a href="http://php.net">PHP</a> and all needed dependencies, including <a href="http://apache.org">apache</a> So now that APC is installed, just restart apache</p>

<div class="highlight"><pre><code class="bash">sudo /etc/init.d/apache2 restart
</code></pre>
</div>


<p> and you're ready to go.  In codeigniter, you don't need to do anything special. Just turn the cache on by putting the following line somewhere in your controller:</p>

<div class="highlight"><pre><code class="php"><span class="x">$this-&amp;gt;output-&amp;gt;cache(n);</span>
</code></pre>
</div>


<p> Where 'n' is the number of minutes to cache that particular content.  The cache library is clever enough to pick the best cache driver from the four available ones (memcached, APC, file and dummy). Forget about the dummy driver: it doesn't do anything</p>

<h3>Benchmarks</h3>


<p>These are the results for 50 concurrent connections : For APC we get about 43 requests/s, with the file caching mecanism around 25, requests/s, and with no cache at all we are below 18 requests/s</p>

<p style="text-align: center;"><a href="http://cdn.jfoucher.com/uploads/2011/02/chart22.png"><img class="aligncenter size-full wp-image-387" title="Codeigniter APC cache benchmark" src="http://cdn.jfoucher.com/uploads/2011/02/chart22.png" alt="APC: 43, File: 25, None: 18 " width="560" height="260" /></a></p>


<p style="text-align: left;">For low concurency (2) the improvement when using APC is similar: in this case the number of requests per second nearly doubled, from 19 to 47 between the case without any caching system and the APC case</p>


<p style="text-align: left;"><a href="http://cdn.jfoucher.com/uploads/2011/02/chart2.png"><img class="aligncenter size-full wp-image-383" title="Codeigniter cache benchmark: low concurency" src="http://cdn.jfoucher.com/uploads/2011/02/chart2.png" alt="APC: 46.37 rps, File: 27.23 rps, None: 18.99 rps" width="560" height="260" /></a></p>


<p style="text-align: left;">So just turning the default codeigniter cache on gives us a significant speed improvement, going all the way and installing APC can nearly double the speed of your application. Not too shabby I should think.</p>


<p style="text-align: left;">It is <strong>so</strong> easy to take advantage of this caching mechasism on Codeigniter 2 that it would really be a pity not to do so!</p>


<p style="text-align: left;">The only caching library missing here is memcached. Have you tried any of these caching libraries with codeigniter 2?</p>


<p style="text-align: left;"></p>


<p>
</p>


<p></p>


                <div class="meta">
                    <!-- <span class="pdf">Download a <a href="/2011/02/installing-running-apc-cache-codeigniter.html.pdf" title="Download a PDF, printer-friendly copy of this article"><acronym title="Portable Document Format">PDF</acronym>, printer-friendly version of this article</a>.</span> -->
                    <span class="permalink">For referencing: <a href="/2011/02/installing-running-apc-cache-codeigniter.html" title="[Permalink] Installing and running APC cache with CodeIgniter">permalink to this article</a>.</span>
                </div> <!-- /.meta -->
            </div> <!-- /.entry-content.colEight -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'geekynuggets'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

            <div class="page-nav-bottom">
                
				    <span class="page-nav-item floatLeft"><a class="internal" rel="prev"  href="/2011/01/wordpress-email-404-notification.html#notebook" title="View Wordpress 404 notification by email">&larr; View previous article</a></span>
				
				
				    <span class="page-nav-item floatRight"><a class="internal" rel="next"  href="/2011/04/the-making-of-flickholdr-an-image-placeholder-generator.html#notebook" title="View The making of flickholdr.com, an image placeholder generator">View next article &rarr;</a></span>
                
            </div> <!-- /.page-nav-bottom -->
        </div> <!-- /#notebook.center.clear -->
                <div id="footer" class="clear">
			<ul class="nav nav-footer caps">
				<li><a href="/about.html" title="About &amp; contact information" tabindex="0">About <span class="amp">&amp;</span> Contact</a></li>
				<li><a href="/archives.html#cover" title="View the blog archives" tabindex="0">Blog</a></li>
				<li><a href="http://github.com/jfoucher" title="Go to the code portfolio of Jonathan Foucher" tabindex="0">Github</a></li>
				<li><a href="http://feeds.feedburner.com/GeekyNuggets" title="Feed link" tabindex="0">Feed</a></li>
			</ul>
			<span class="backtop floatRight"><a class="internal" href="#header" title="Return to the top of this page">Back to top &uarr;</a></span>
			<div class="page-meta clear">
				<div class="info">
					
					<p class="copyright ">
                        This blog has been online in one form or another since
                        <span class="date" title="March 2004">2004</span>&thinsp;&mdash;&thinsp;copyright &copy; Jonathan
                        Foucher.&thinsp;&mdash;&thinsp;<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"
                           title="You can use this for non-comercial purposes, provided you cite me as the author, and do not modify the content">
                            Creative Commons License
                        </a>.
                    </p>
				</div>

			</div> <!-- /.page-meta.clear -->
		</div> <!-- /#footer.center.clear -->
	</div>
</body>
</html>
